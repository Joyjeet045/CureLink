{% extends "base.html" %}
{% block content %}
<style>
  .test-item {
    transition: all 0.3s ease;
    border: 2px solid transparent;
  }
  
  .test-item.highlighted {
    background: linear-gradient(135deg, #fff3cd, #ffeaa7);
    border-color: #ffc107;
    box-shadow: 0 4px 12px rgba(255, 193, 7, 0.3);
    transform: translateY(-2px);
  }
  
  .test-item.highlighted .fw-bold {
    color: #856404;
  }
  
  .prescription-badge {
    background: linear-gradient(135deg, #dc3545, #c82333);
    color: white;
    font-size: 0.75rem;
    padding: 2px 8px;
    border-radius: 12px;
    margin-left: 8px;
  }
  
  .highlight-notice {
    background: linear-gradient(135deg, #fff3cd, #ffeaa7);
    border: 1px solid #ffc107;
    border-radius: 8px;
    padding: 12px 16px;
    margin-bottom: 20px;
    color: #856404;
    font-weight: 500;
  }
  
  .highlight-notice i {
    margin-right: 8px;
    color: #ffc107;
  }
</style>

<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="fw-bold mb-4 text-success">Tests</h2>
    {% if request.session.cart and request.session.cart.tests %}
      <div class="d-flex gap-2">
        <a href="{% url 'test_cart_checkout' %}" class="btn btn-success position-relative">
          <i class="fas fa-shopping-cart"></i>
          Checkout
          <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
            {{ request.session.cart.tests|length }}
          </span>
        </a>
      </div>
    {% else %}
      <div class="btn btn-outline-secondary position-relative">
        <i class="fas fa-shopping-cart"></i>
        <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
          0
        </span>
      </div>
    {% endif %}
  </div>
  
  {% if highlight_id %}
    <div class="highlight-notice">
      <i class="fas fa-stethoscope"></i>
      <strong>Prescribed Test:</strong> This test has been prescribed by your doctor. Click "View Hospitals" to book it.
    </div>
  {% endif %}
  
  <p class="text-center text-muted">Book tests and diagnostics here.</p>
  <div class="list-group mt-4">
    {% for test in test_types %}
      <div class="list-group-item test-item d-flex justify-content-between align-items-center {% if highlight_id == test.id|stringformat:'s' %}highlighted{% endif %}">
        <div>
          <span class="fw-bold">{{ test.name }}</span>
          <span class="badge bg-info text-dark ms-2">{{ test.get_sample_required_display }}</span>
          {% if highlight_id == test.id|stringformat:'s' %}
            <span class="prescription-badge">Prescribed</span>
          {% endif %}
        </div>
        <a href="{% url 'view_hospitals_for_testtype' test.id %}" class="btn btn-outline-primary btn-sm">View Hospitals</a>
      </div>
    {% empty %}
      <div class="text-center text-muted">No tests available.</div>
    {% endfor %}
  </div>
</div>

<script>
// Auto-scroll to highlighted test if present
document.addEventListener('DOMContentLoaded', function() {
  const highlightedTest = document.querySelector('.test-item.highlighted');
  if (highlightedTest) {
    highlightedTest.scrollIntoView({ 
      behavior: 'smooth', 
      block: 'center' 
    });
    
    // Add a subtle pulse animation
    highlightedTest.style.animation = 'pulse 2s infinite';
  }
});

// Add CSS animation for pulse effect
const style = document.createElement('style');
style.textContent = `
  @keyframes pulse {
    0% { box-shadow: 0 4px 12px rgba(255, 193, 7, 0.3); }
    50% { box-shadow: 0 4px 20px rgba(255, 193, 7, 0.6); }
    100% { box-shadow: 0 4px 12px rgba(255, 193, 7, 0.3); }
  }
`;
document.head.appendChild(style);
</script>
{% endblock %} 